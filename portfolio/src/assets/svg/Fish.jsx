import React, { useRef } from 'react';
import { motion, useInView } from 'framer-motion';

const Fish = (props) => {

    // const ref viene utilizzata per <svg> sfruttando useInView per animare gli elementi figli
    const ref = useRef(null);
    const isInView = useInView(ref, {
        once: true,
        amount: 1,
    })

    /*
    Se repeatCount viene passato come prop al componente Fish, il valore di repeatCount sarà quello fornito 
    Se non viene fornito, il valore predefinito sarà 21
    */
    const repeatCount = props.repeatCount || 21;

    return (
        <svg
            ref={ref}
            height="180px" 
            width="180px" 
            version="1.1" 
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 360.05 360.05" 
            transform="rotate(-45)"
            strokeWidth="1.080141"
            {...props}
        >
            <g>
                <path fill="#35a0e1" d="M340.25,180.019c0,4.85-0.2,9.66-0.6,14.41c-0.427,5.095-13.769,24.713-14.635,29.67 c-2.599,14.87,5.561,14.485-0.634,27.76c-27.08,58.06-85.97,98.29-154.26,98.29c-27.85,0-54.15-6.7-77.36-18.56 C37.7,303.418,0,246.119,0,180.019c0-16.92,2.47-33.27,7.08-48.69c0.21-0.73,0.43-1.46,0.66-2.18 c9.34-29.86,26.7-56.19,49.56-76.46c30.02-26.62,69.54-42.79,112.82-42.79C264.08,9.898,340.25,86.059,340.25,180.019z" />
                <path fill="#d7004b" d="M177.32,100.168L7.08,131.329c0.21-0.73,0.43-1.46,0.66-2.18c9.34-29.86,26.7-56.19,49.56-76.46 c50.43-19.47,99.04-24.69,99.04-24.69C151.4,68.378,177.32,100.168,177.32,100.168z" />
                <path fill="#e5e5f7" d="M328.565,234.832c0,0,3.993-16.894,29.485-22.164c-0.815-3.811-2.976-7.375-6.499-9.86l-11.9-8.38 l-72.93-51.34l-14.14-9.96c-56.06-39.46-128.04-48.48-192.09-24.08l-52.75,20.1C2.71,145.209,0,162.299,0,180.019 c0,66.1,37.7,123.4,92.76,151.57c67.69,3.57,134.82-14.04,191.99-50.32c11.43-7.24,22.47-15.24,33.04-23.96l6.59-5.45l28.16-23.26 c1.959-1.618,3.409-3.578,4.389-5.7C348.221,224.889,336.485,228.543,328.565,234.832z" />
                
                {/* Pinna animata */}
                <motion.path 
                    fill="#d7004b" 
                    d="M218.967,258.729c0,0-34.905-13.327-88.006,1.232c-12.197,3.344-15.965,18.786-6.799,27.499 c20.069,19.077,57.271,40.02,104.693,1.759l-2.021-1.617C218.218,280.709,215.039,269.041,218.967,258.729L218.967,258.729z"
                    animate={isInView ? {
                        scaleY: [1, 0.5, 1]
                    } : {
                        scaleY: 1
                    }}
                    transition={{
                        duration: 0.35,
                        repeat: isInView ? repeatCount : 0,
                        ease: "easeInOut"
                    }}
                />
                
                <path fill="#d7004b" d="M328.565,234.832c0,0,4.202-17.765,31.482-22.542c-0.776-2.711-2.435-5.209-4.98-7.001 l-88.351-62.199c0,0-53.522,41.471-41.161,105.746c3.51,18.244,28.126,37.928,59.195,32.434 c11.434-7.243,22.472-15.24,33.04-23.967l38.069-31.445c1.189-0.982,2.143-2.124,2.879-3.358 C349.909,224.383,337.049,228.094,328.565,234.832z" />
                <circle fill="#FFFFFF" cx="311.26" cy="210.111" r="15.657" />
                <circle fill="#140198" cx="311.26" cy="210.111" r="6.73" />
            </g>
        </svg>
    );
};

export default Fish